module.exports=[57691,a=>{"use strict";var b=a.i(56856),c=a.i(55132),d=a.i(59165),e=a.i(62205),f=a.i(9098),g=a.i(61981),h=a.i(89280),i=a.i(6771),j=a.i(55806),k=a.i(34122),l=a.i(3683),m=a.i(48154),n=a.i(81777),o=a.i(62104),p=a.i(32775),q=a.i(45117),r=a.i(11338),s=a.i(13874),t=a.i(13541),u=a.i(8607),v=a.i(21712),w=a.i(26281),x=a.i(17708),y=a.i(60750),z=a.i(6845);function A(){let[a,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(1),[L,M]=(0,c.useState)(20),[N,O]=(0,c.useState)(0),[P,Q]=(0,c.useState)("");async function R(a=J,b=L,c=P){E(!0);try{let e=new URLSearchParams;c&&e.set("q",c),a&&e.set("page",String(a)),b&&e.set("pageSize",String(b));let f=await (0,d.default)("/master/sites?"+e.toString());Array.isArray(f)?(A(f),O(0)):(A(f.data||[]),O(f.meta?.total||0),K(f.meta?.page||a),M(f.meta?.pageSize||b))}catch(a){console.error(a),alert(a?.body?.message||a?.message||"Load failed")}finally{E(!1)}}async function S(){try{let a=await (0,d.default)("/master/hubs");C(Array.isArray(a)?a:[])}catch(a){console.error(a)}}async function T(){if(!H||!H.name)return alert("Name required");try{H.id?await (0,d.default)(`/master/sites/${H.id}`,{method:"PATCH",body:H}):await (0,d.default)("/master/sites",{method:"POST",body:H}),G(!1),I(null),await R()}catch(a){alert(a?.body?.message||a?.message||"Save failed")}}async function U(a){if(confirm("Hapus site?"))try{await (0,d.default)(`/master/sites/${a}`,{method:"DELETE"}),await R()}catch(a){alert(a?.body?.message||a?.message||"Delete failed")}}return(0,c.useEffect)(()=>{R(),S()},[]),(0,b.jsxs)(e.default,{sx:{p:2},children:[(0,b.jsxs)(e.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,b.jsxs)(e.default,{children:[(0,b.jsx)(e.default,{component:"h2",sx:{m:0},children:"Sites"}),(0,b.jsx)(e.default,{sx:{color:"text.secondary",fontSize:13},children:"Manage sites and assign to hubs"})]}),(0,b.jsxs)(e.default,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,b.jsx)(s.default,{size:"small",placeholder:"Search",value:P,onChange:a=>Q(a.target.value),onKeyDown:a=>{"Enter"===a.key&&(K(1),R(1,L,a.target.value))}}),(0,b.jsx)(g.default,{variant:"outlined",onClick:()=>{K(1),R(1,L,P)},startIcon:D?(0,b.jsx)(v.default,{size:18}):null,children:"Search"}),(0,b.jsx)(g.default,{variant:"outlined",onClick:()=>{Q(""),K(1),R(1,L,"")},sx:{ml:1},children:"Clear"}),(0,b.jsx)(g.default,{variant:"outlined",onClick:()=>R(J,L,P),startIcon:D?(0,b.jsx)(v.default,{size:18}):null,children:"Refresh"}),(0,b.jsx)(g.default,{variant:"contained",sx:{ml:1},startIcon:(0,b.jsx)(z.default,{}),onClick:function(){I({name:"",code:"",hub_id:null,location:""}),G(!0)},children:"Create Site"})]})]}),(0,b.jsx)(f.default,{children:(0,b.jsx)(l.default,{children:(0,b.jsxs)(i.default,{size:"small",children:[(0,b.jsx)(m.default,{children:(0,b.jsxs)(n.default,{children:[(0,b.jsx)(k.default,{children:"ID"}),(0,b.jsx)(k.default,{children:"Code"}),(0,b.jsx)(k.default,{children:"Name"}),(0,b.jsx)(k.default,{children:"Hub"}),(0,b.jsx)(k.default,{children:"Location"}),(0,b.jsx)(k.default,{align:"right",children:"Action"})]})}),(0,b.jsx)(j.default,{children:a.map(a=>(0,b.jsxs)(n.default,{hover:!0,children:[(0,b.jsx)(k.default,{children:a.id}),(0,b.jsx)(k.default,{children:a.code||"-"}),(0,b.jsx)(k.default,{children:a.name}),(0,b.jsx)(k.default,{children:a.hub?a.hub.name:"-"}),(0,b.jsx)(k.default,{children:a.location||"-"}),(0,b.jsxs)(k.default,{align:"right",children:[(0,b.jsx)(w.default,{title:"Edit",children:(0,b.jsx)(h.default,{size:"small",onClick:()=>{I({...a,hub_id:a.hub?a.hub.id:null}),G(!0)},children:(0,b.jsx)(x.default,{fontSize:"small"})})}),(0,b.jsx)(w.default,{title:"Delete",children:(0,b.jsx)(h.default,{size:"small",color:"error",onClick:()=>U(a.id),children:(0,b.jsx)(y.default,{fontSize:"small"})})})]})]},a.id))})]})})}),(0,b.jsxs)(e.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1},children:[(0,b.jsxs)(e.default,{children:[(0,b.jsx)(g.default,{size:"small",disabled:J<=1,onClick:()=>{let a=Math.max(1,J-1);K(a),R(a,L,P)},children:"Prev"}),(0,b.jsx)(g.default,{size:"small",sx:{ml:1},disabled:L<=0||N>0&&J*L>=N,onClick:()=>{let a=J+1;K(a),R(a,L,P)},children:"Next"}),(0,b.jsxs)(e.default,{component:"span",sx:{ml:2,color:"text.secondary"},children:["Page ",J," ",N?`of ${Math.ceil(N/L)}`:""]})]}),(0,b.jsxs)(e.default,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,b.jsx)(e.default,{sx:{color:"text.secondary",fontSize:13},children:"Per page"}),(0,b.jsxs)(t.default,{size:"small",value:L,onChange:a=>{let b=Number(a.target.value);M(b),K(1),R(1,b,P)},children:[(0,b.jsx)(u.default,{value:10,children:"10"}),(0,b.jsx)(u.default,{value:20,children:"20"}),(0,b.jsx)(u.default,{value:50,children:"50"})]})]})]}),(0,b.jsxs)(o.default,{open:F,onClose:()=>{G(!1),I(null)},fullWidth:!0,children:[(0,b.jsx)(p.default,{children:H?.id?"Edit Site":"Create Site"}),(0,b.jsx)(q.default,{children:(0,b.jsxs)(e.default,{sx:{display:"grid",gap:2,mt:1},children:[(0,b.jsx)(s.default,{label:"Code",size:"small",value:H?.code||"",onChange:a=>I({...H,code:a.target.value})}),(0,b.jsx)(s.default,{label:"Name",size:"small",value:H?.name||"",onChange:a=>I({...H,name:a.target.value})}),(0,b.jsxs)(t.default,{size:"small",value:H?.hub_id??"",onChange:a=>I({...H,hub_id:a.target.value||null}),children:[(0,b.jsx)(u.default,{value:"",children:(0,b.jsx)("em",{children:"None"})}),B.map(a=>(0,b.jsx)(u.default,{value:a.id,children:a.name},a.id))]}),(0,b.jsx)(s.default,{label:"Location",size:"small",value:H?.location||"",onChange:a=>I({...H,location:a.target.value})})]})}),(0,b.jsxs)(r.default,{children:[(0,b.jsx)(g.default,{onClick:()=>{G(!1),I(null)},children:"Cancel"}),(0,b.jsx)(g.default,{variant:"contained",onClick:T,children:"Save"})]})]})]})}a.s(["default",()=>A])}];

//# sourceMappingURL=web_app_master_sites_page_jsx_8ca520f8._.js.map