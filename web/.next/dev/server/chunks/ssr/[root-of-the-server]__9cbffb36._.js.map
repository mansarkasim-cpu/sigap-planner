{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/app/MuiProviders.jsx"],"sourcesContent":["'use client'\r\nimport { ThemeProvider, createTheme } from '@mui/material/styles'\r\nimport CssBaseline from '@mui/material/CssBaseline'\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: { main: '#7c3aed' },\r\n    secondary: { main: '#6d28d9' },\r\n    background: { default: '#fafafa', paper: '#fff' },\r\n  },\r\n  typography: {\r\n    fontFamily: \"Inter, Roboto, 'Helvetica Neue', Arial\",\r\n  },\r\n  shape: { borderRadius: 12 },\r\n})\r\n\r\nexport default function MuiProviders({ children }){\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CssBaseline />\r\n      {children}\r\n    </ThemeProvider>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AAAA;AACA;AAFA;;;;AAIA,MAAM,QAAQ,IAAA,0NAAW,EAAC;IACxB,SAAS;QACP,SAAS;YAAE,MAAM;QAAU;QAC3B,WAAW;YAAE,MAAM;QAAU;QAC7B,YAAY;YAAE,SAAS;YAAW,OAAO;QAAO;IAClD;IACA,YAAY;QACV,YAAY;IACd;IACA,OAAO;QAAE,cAAc;IAAG;AAC5B;AAEe,SAAS,aAAa,EAAE,QAAQ,EAAE;IAC/C,qBACE,qPAAC,gOAAa;QAAC,OAAO;;0BACpB,qPAAC,iLAAW;;;;;YACX;;;;;;;AAGP"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/components/RouteGuard.jsx"],"sourcesContent":["\"use client\"\r\nimport { useEffect } from 'react'\r\nimport { usePathname, useRouter } from 'next/navigation'\r\n\r\nexport default function RouteGuard(){\r\n  const pathname = usePathname()\r\n  const router = useRouter()\r\n\r\n  useEffect(()=>{\r\n    if (typeof window === 'undefined') return\r\n    const token = localStorage.getItem('token')\r\n    // allow unauthenticated access to public pages\r\n    const publicPaths = ['/login','/']\r\n    if (publicPaths.some(p => pathname === p)) return\r\n\r\n    // For all other pages, require token\r\n    if (!token) router.push('/login')\r\n  }, [pathname, router])\r\n\r\n  return null\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;AAIe,SAAS;IACtB,MAAM,WAAW,IAAA,wJAAW;IAC5B,MAAM,SAAS,IAAA,sJAAS;IAExB,IAAA,yNAAS,EAAC;QACR,wCAAmC;;;QACnC,MAAM;QACN,+CAA+C;QAC/C,MAAM;IAKR,GAAG;QAAC;QAAU;KAAO;IAErB,OAAO;AACT"}},
    {"offset": {"line": 110, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/components/AuthButton.jsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useState } from 'react';\r\nimport Link from 'next/link';\r\nimport LogoutIcon from '@mui/icons-material/Logout';\r\n\r\nexport default function AuthButton() {\r\n  const [token, setToken] = useState(null);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const t = localStorage.getItem('token');\r\n      setToken(t);\r\n    } catch (e) {\r\n      setToken(null);\r\n    }\r\n  }, []);\r\n\r\n  function logout() {\r\n    try { localStorage.removeItem('token'); } catch (e) {}\r\n    try { localStorage.removeItem('sigap_user'); } catch (e) {}\r\n    try { localStorage.removeItem('sigap_role'); } catch (e) {}\r\n    try { document.cookie = 'token=; Path=/; Max-Age=0' } catch (e) {}\r\n    try { document.cookie = 'sigap_user=; Path=/; Max-Age=0' } catch (e) {}\r\n    try { document.cookie = 'sigap_role=; Path=/; Max-Age=0' } catch (e) {}\r\n    // force reload so client components re-evaluate auth state\r\n    if (typeof window !== 'undefined') window.location.reload();\r\n  }\r\n\r\n  if (token) {\r\n    return (\r\n      <button onClick={logout} title=\"Logout\" aria-label=\"Logout\" style={{ background: 'transparent', border: 'none', cursor: 'pointer', padding: 0 }} className=\"nav-link\">\r\n        <LogoutIcon style={{ fontSize: 18 }} />\r\n      </button>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Link href=\"/login\" className=\"nav-link\">Login</Link>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAHA;;;;;AAKe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,wNAAQ,EAAC;IAEnC,IAAA,yNAAS,EAAC;QACR,IAAI;YACF,MAAM,IAAI,aAAa,OAAO,CAAC;YAC/B,SAAS;QACX,EAAE,OAAO,GAAG;YACV,SAAS;QACX;IACF,GAAG,EAAE;IAEL,SAAS;QACP,IAAI;YAAE,aAAa,UAAU,CAAC;QAAU,EAAE,OAAO,GAAG,CAAC;QACrD,IAAI;YAAE,aAAa,UAAU,CAAC;QAAe,EAAE,OAAO,GAAG,CAAC;QAC1D,IAAI;YAAE,aAAa,UAAU,CAAC;QAAe,EAAE,OAAO,GAAG,CAAC;QAC1D,IAAI;YAAE,SAAS,MAAM,GAAG;QAA4B,EAAE,OAAO,GAAG,CAAC;QACjE,IAAI;YAAE,SAAS,MAAM,GAAG;QAAiC,EAAE,OAAO,GAAG,CAAC;QACtE,IAAI;YAAE,SAAS,MAAM,GAAG;QAAiC,EAAE,OAAO,GAAG,CAAC;QACtE,2DAA2D;QAC3D;;IACF;IAEA,IAAI,OAAO;QACT,qBACE,qPAAC;YAAO,SAAS;YAAQ,OAAM;YAAS,cAAW;YAAS,OAAO;gBAAE,YAAY;gBAAe,QAAQ;gBAAQ,QAAQ;gBAAW,SAAS;YAAE;YAAG,WAAU;sBACzJ,cAAA,qPAAC,sKAAU;gBAAC,OAAO;oBAAE,UAAU;gBAAG;;;;;;;;;;;IAGxC;IAEA,qBACE,qPAAC,8KAAI;QAAC,MAAK;QAAS,WAAU;kBAAW;;;;;;AAE7C"}},
    {"offset": {"line": 197, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/lib/api-client.ts"],"sourcesContent":["// lib/api-client.ts\r\nexport type ApiOptions = RequestInit & { body?: any };\r\n\r\nconst API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:4000/api';\r\n\r\nasync function handleResp(res: Response) {\r\n  const text = await res.text();\r\n  let data;\r\n  try { data = text ? JSON.parse(text) : undefined; } catch { data = text; }\r\n  if (!res.ok) {\r\n    const err: any = new Error(data?.message || res.statusText || 'API error');\r\n    err.status = res.status;\r\n    err.body = data;\r\n    throw err;\r\n  }\r\n  return data;\r\n}\r\n\r\nexport default async function apiClient(path: string, opts: ApiOptions = {}) {\r\n  const url = path.startsWith('http') ? path : `${API_BASE}${path.startsWith('/') ? '' : '/'}${path}`;\r\n\r\n  function getAuthHeader(): Record<string,string> {\r\n    try {\r\n      if (typeof window === 'undefined') return {};\r\n      const token = (localStorage.getItem('token') || '').trim();\r\n      return token ? { Authorization: `Bearer ${token}` } : {};\r\n    } catch (e) {\r\n      return {};\r\n    }\r\n  }\r\n\r\n  const headers: Record<string,string> = {\r\n    'Accept': 'application/json',\r\n    ...getAuthHeader(),\r\n    ...(opts.headers as Record<string,string> || {}),\r\n  };\r\n\r\n  let body: BodyInit | undefined;\r\n  if (opts.body !== undefined) {\r\n    headers['Content-Type'] = 'application/json';\r\n    body = JSON.stringify(opts.body);\r\n  }\r\n\r\n  let res: Response | undefined;\r\n  try {\r\n    // emit loading start (maintain a counter on window to support concurrent requests)\r\n    try {\r\n      if (typeof window !== 'undefined') {\r\n        // @ts-ignore\r\n        window.__apiLoadingCounter = (window.__apiLoadingCounter || 0) + 1;\r\n        // @ts-ignore\r\n        window.dispatchEvent(new CustomEvent('api-loading', { detail: { count: window.__apiLoadingCounter } }));\r\n      }\r\n    } catch (_) {}\r\n    res = await fetch(url, {\r\n      credentials: 'include',\r\n      ...opts,\r\n      headers,\r\n      body,\r\n    });\r\n    return await handleResp(res);\r\n  } catch (err: any) {\r\n    // If the error already comes from `handleResp` it may contain HTTP error details\r\n    // (status, body). Preserve those properties when rethrowing so callers can\r\n    // inspect `err.status` / `err.body` instead of losing them behind a wrapper.\r\n    if (err && (err as any).body !== undefined) {\r\n      // ensure url is available on the propagated error\r\n      try { (err as any).url = url; } catch (_) {}\r\n      throw err;\r\n    }\r\n\r\n    // Network-level error (CORS, DNS, connection refused, etc)\r\n    const e: any = new Error(err?.message || 'Network error');\r\n    e.detail = err;\r\n    e.url = url;\r\n    throw e;\r\n  } finally {\r\n    try {\r\n      if (typeof window !== 'undefined') {\r\n        // @ts-ignore\r\n        window.__apiLoadingCounter = Math.max(0, (window.__apiLoadingCounter || 1) - 1);\r\n        // @ts-ignore\r\n        window.dispatchEvent(new CustomEvent('api-loading', { detail: { count: window.__apiLoadingCounter } }));\r\n      }\r\n    } catch (_) {}\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,oBAAoB;;;;;AAGpB,MAAM,WAAW,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AAEpD,eAAe,WAAW,GAAa;IACrC,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,IAAI;IACJ,IAAI;QAAE,OAAO,OAAO,KAAK,KAAK,CAAC,QAAQ;IAAW,EAAE,OAAM;QAAE,OAAO;IAAM;IACzE,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,MAAW,IAAI,MAAM,MAAM,WAAW,IAAI,UAAU,IAAI;QAC9D,IAAI,MAAM,GAAG,IAAI,MAAM;QACvB,IAAI,IAAI,GAAG;QACX,MAAM;IACR;IACA,OAAO;AACT;AAEe,eAAe,UAAU,IAAY,EAAE,OAAmB,CAAC,CAAC;IACzE,MAAM,MAAM,KAAK,UAAU,CAAC,UAAU,OAAO,GAAG,WAAW,KAAK,UAAU,CAAC,OAAO,KAAK,MAAM,MAAM;IAEnG,SAAS;QACP,IAAI;YACF,wCAAmC,OAAO,CAAC;;;YAC3C,MAAM;QAER,EAAE,OAAO,GAAG;YACV,OAAO,CAAC;QACV;IACF;IAEA,MAAM,UAAiC;QACrC,UAAU;QACV,GAAG,eAAe;QAClB,GAAI,KAAK,OAAO,IAA6B,CAAC,CAAC;IACjD;IAEA,IAAI;IACJ,IAAI,KAAK,IAAI,KAAK,WAAW;QAC3B,OAAO,CAAC,eAAe,GAAG;QAC1B,OAAO,KAAK,SAAS,CAAC,KAAK,IAAI;IACjC;IAEA,IAAI;IACJ,IAAI;QACF,mFAAmF;QACnF,IAAI;YACF;;QAMF,EAAE,OAAO,GAAG,CAAC;QACb,MAAM,MAAM,MAAM,KAAK;YACrB,aAAa;YACb,GAAG,IAAI;YACP;YACA;QACF;QACA,OAAO,MAAM,WAAW;IAC1B,EAAE,OAAO,KAAU;QACjB,iFAAiF;QACjF,2EAA2E;QAC3E,6EAA6E;QAC7E,IAAI,OAAO,AAAC,IAAY,IAAI,KAAK,WAAW;YAC1C,kDAAkD;YAClD,IAAI;gBAAG,IAAY,GAAG,GAAG;YAAK,EAAE,OAAO,GAAG,CAAC;YAC3C,MAAM;QACR;QAEA,2DAA2D;QAC3D,MAAM,IAAS,IAAI,MAAM,KAAK,WAAW;QACzC,EAAE,MAAM,GAAG;QACX,EAAE,GAAG,GAAG;QACR,MAAM;IACR,SAAU;QACR,IAAI;YACF;;QAMF,EAAE,OAAO,GAAG,CAAC;IACf;AACF"}},
    {"offset": {"line": 282, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/components/Nav.jsx"],"sourcesContent":["\"use client\"\r\nimport Link from 'next/link'\r\nimport { usePathname } from 'next/navigation'\r\nimport AuthButton from './AuthButton'\r\nimport { useEffect, useState } from 'react'\r\nimport apiClient from '../lib/api-client'\r\n\r\nfunction isAdminRole(raw) {\r\n  if (!raw) return false\r\n  try {\r\n    if (typeof raw === 'string') {\r\n      // maybe a JSON string\r\n      if (raw.startsWith('[') || raw.startsWith('{')) {\r\n        const parsed = JSON.parse(raw)\r\n        if (Array.isArray(parsed)) return parsed.map(String).some(r => r.toLowerCase() === 'admin')\r\n        if (typeof parsed === 'string') return parsed.toLowerCase() === 'admin'\r\n        if (parsed && parsed.role) return String(parsed.role).toLowerCase() === 'admin'\r\n      }\r\n      return raw.toLowerCase() === 'admin'\r\n    }\r\n    if (Array.isArray(raw)) return raw.map(String).some(r => r.toLowerCase() === 'admin')\r\n    if (typeof raw === 'object') {\r\n      if (raw.role) return String(raw.role).toLowerCase() === 'admin'\r\n    }\r\n  } catch (e) {}\r\n  return false\r\n}\r\n\r\nexport default function Nav(){\r\n  const pathname = usePathname()\r\n  const [isAdmin, setIsAdmin] = useState(false)\r\n\r\n  useEffect(()=>{\r\n    let mounted = true\r\n    async function loadRole(){\r\n      try{\r\n        let raw = localStorage.getItem('sigap_role')\r\n        if (!raw){\r\n          const token = localStorage.getItem('token')\r\n          if (token){\r\n            // try server-side /auth/me to get role\r\n            try{\r\n              const me = await apiClient('/auth/me')\r\n              const roleVal = me?.role || (me?.user && me.user.role) || null\r\n              if (roleVal) {\r\n                const roleStr = typeof roleVal === 'string' ? roleVal : JSON.stringify(roleVal)\r\n                localStorage.setItem('sigap_role', roleStr)\r\n                raw = roleStr\r\n              }\r\n            }catch(e){/* ignore */}\r\n          }\r\n        }\r\n        if (mounted) setIsAdmin(isAdminRole(raw))\r\n      }catch(e){ if (mounted) setIsAdmin(false) }\r\n    }\r\n    loadRole()\r\n    return ()=>{ mounted = false }\r\n  }, [])\r\n\r\n  // hide nav on login page\r\n  if (typeof pathname === 'string' && pathname === '/login') return null\r\n\r\n  return (\r\n    <nav className=\"nav\">\r\n      <ul className=\"nav-menu\">\r\n        <li className=\"nav-item\"><Link href=\"/dashboard\" className=\"nav-link\">Dashboard</Link></li>\r\n\r\n        {isAdmin && (\r\n          <li className=\"nav-item has-sub\">\r\n            <span className=\"nav-link\">Master</span>\r\n            <ul className=\"sub-menu\">\r\n              <li><Link href=\"/users\" className=\"nav-link\">Users</Link></li>\r\n            </ul>\r\n          </li>\r\n        )}\r\n\r\n        <li className=\"nav-item has-sub\">\r\n          <span className=\"nav-link\">Konfigurasi</span>\r\n          <ul className=\"sub-menu\">\r\n            <li><Link href=\"/shifts\" className=\"nav-link\">Shift</Link></li>\r\n          </ul>\r\n        </li>\r\n\r\n        <li className=\"nav-item has-sub\">\r\n          <span className=\"nav-link\">Work Order</span>\r\n          <ul className=\"sub-menu\">\r\n            <li><Link href=\"/work-orders\" className=\"nav-link\">List</Link></li>\r\n            <li><Link href=\"/gantt\" className=\"nav-link\">Gantt Chart</Link></li>\r\n          </ul>\r\n        </li>\r\n\r\n        <li className=\"nav-item auth-item\"><AuthButton /></li>\r\n      </ul>\r\n    </nav>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}