{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/app/login/page.jsx"],"sourcesContent":["\"use client\"\r\nimport { useState } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport Box from '@mui/material/Box'\r\nimport Paper from '@mui/material/Paper'\r\nimport TextField from '@mui/material/TextField'\r\nimport Button from '@mui/material/Button'\r\nimport Typography from '@mui/material/Typography'\r\nimport Alert from '@mui/material/Alert'\r\nimport CircularProgress from '@mui/material/CircularProgress'\r\nimport apiClient from '../../lib/api-client'\r\n\r\nexport default function LoginPage(){\r\n  const router = useRouter()\r\n  const [nipp, setNipp] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState('')\r\n\r\n  async function handleSubmit(e){\r\n    e.preventDefault()\r\n    setError('')\r\n    setLoading(true)\r\n    try{\r\n      const res = await apiClient('/auth/login', { method: 'POST', body: { nipp, password } })\r\n      const token = res?.accessToken || res?.token || res?.access_token\r\n      if (!token) throw new Error('No token returned')\r\n      try { localStorage.setItem('token', token) } catch (e) {}\r\n      try { document.cookie = `token=${token}; Path=/; SameSite=Lax` } catch (e) {}\r\n      try {\r\n        const name = res?.user?.name || res?.user?.username || res?.user?.nipp || nipp\r\n        if (name) {\r\n          localStorage.setItem('sigap_user', name)\r\n          try { document.cookie = `sigap_user=${encodeURIComponent(name)}; Path=/; SameSite=Lax` } catch (e) {}\r\n        }\r\n        // persist role information if present\r\n        const role = res?.user?.role || res?.user?.roles || res?.roles\r\n        if (role) {\r\n          // store as JSON string when array/object\r\n          const roleValue = typeof role === 'string' ? role : JSON.stringify(role)\r\n          try { localStorage.setItem('sigap_role', roleValue) } catch (e) {}\r\n          try { document.cookie = `sigap_role=${encodeURIComponent(roleValue)}; Path=/; SameSite=Lax` } catch (e) {}\r\n        }\r\n      } catch (e) {}\r\n      router.push('/dashboard')\r\n    }catch(err){\r\n      console.error('login error', err)\r\n      setError(err?.message || 'Login failed')\r\n    }finally{ setLoading(false) }\r\n  }\r\n\r\n  return (\r\n    <Box sx={{minHeight:'70vh', display:'flex', alignItems:'center', justifyContent:'center', py:6}}>\r\n      <Paper elevation={6} sx={{width:'100%', maxWidth:480, p:4, borderRadius:2}}>\r\n        <Box sx={{textAlign:'center', mb:2}}>\r\n          <Typography variant=\"h5\" sx={{fontWeight:700}}>SigapPlanner</Typography>\r\n          <Typography variant=\"body2\" color=\"text.secondary\">Masuk untuk melanjutkan ke Planner</Typography>\r\n        </Box>\r\n\r\n        {error && <Alert severity=\"error\" sx={{mb:2}}>{error}</Alert>}\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <TextField label=\"NIPP\" value={nipp} onChange={e=>setNipp(e.target.value)} fullWidth sx={{mb:2}} />\r\n          <TextField label=\"Password\" type=\"password\" value={password} onChange={e=>setPassword(e.target.value)} fullWidth sx={{mb:2}} />\r\n\r\n          <Box sx={{display:'flex', alignItems:'center', justifyContent:'space-between', mt:2}}>\r\n            <Button type=\"submit\" variant=\"contained\" disabled={loading}>\r\n              {loading ? <CircularProgress size={18} color=\"inherit\" /> : 'Masuk'}\r\n            </Button>\r\n            <Button variant=\"text\" onClick={()=>router.push('/')}>\r\n              Kembali\r\n            </Button>\r\n          </Box>\r\n        </form>\r\n      </Paper>\r\n    </Box>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;;;;;;;;;;;;AAYe,SAAS;IACtB,MAAM,SAAS,IAAA,sJAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,wNAAQ,EAAC;IACjC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wNAAQ,EAAC;IACzC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,wNAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,wNAAQ,EAAC;IAEnC,eAAe,aAAa,CAAC;QAC3B,EAAE,cAAc;QAChB,SAAS;QACT,WAAW;QACX,IAAG;YACD,MAAM,MAAM,MAAM,IAAA,sIAAS,EAAC,eAAe;gBAAE,QAAQ;gBAAQ,MAAM;oBAAE;oBAAM;gBAAS;YAAE;YACtF,MAAM,QAAQ,KAAK,eAAe,KAAK,SAAS,KAAK;YACrD,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM;YAC5B,IAAI;gBAAE,aAAa,OAAO,CAAC,SAAS;YAAO,EAAE,OAAO,GAAG,CAAC;YACxD,IAAI;gBAAE,SAAS,MAAM,GAAG,CAAC,MAAM,EAAE,MAAM,sBAAsB,CAAC;YAAC,EAAE,OAAO,GAAG,CAAC;YAC5E,IAAI;gBACF,MAAM,OAAO,KAAK,MAAM,QAAQ,KAAK,MAAM,YAAY,KAAK,MAAM,QAAQ;gBAC1E,IAAI,MAAM;oBACR,aAAa,OAAO,CAAC,cAAc;oBACnC,IAAI;wBAAE,SAAS,MAAM,GAAG,CAAC,WAAW,EAAE,mBAAmB,MAAM,sBAAsB,CAAC;oBAAC,EAAE,OAAO,GAAG,CAAC;gBACtG;gBACA,sCAAsC;gBACtC,MAAM,OAAO,KAAK,MAAM,QAAQ,KAAK,MAAM,SAAS,KAAK;gBACzD,IAAI,MAAM;oBACR,yCAAyC;oBACzC,MAAM,YAAY,OAAO,SAAS,WAAW,OAAO,KAAK,SAAS,CAAC;oBACnE,IAAI;wBAAE,aAAa,OAAO,CAAC,cAAc;oBAAW,EAAE,OAAO,GAAG,CAAC;oBACjE,IAAI;wBAAE,SAAS,MAAM,GAAG,CAAC,WAAW,EAAE,mBAAmB,WAAW,sBAAsB,CAAC;oBAAC,EAAE,OAAO,GAAG,CAAC;gBAC3G;YACF,EAAE,OAAO,GAAG,CAAC;YACb,OAAO,IAAI,CAAC;QACd,EAAC,OAAM,KAAI;YACT,QAAQ,KAAK,CAAC,eAAe;YAC7B,SAAS,KAAK,WAAW;QAC3B,SAAQ;YAAE,WAAW;QAAO;IAC9B;IAEA,qBACE,qPAAC,iKAAG;QAAC,IAAI;YAAC,WAAU;YAAQ,SAAQ;YAAQ,YAAW;YAAU,gBAAe;YAAU,IAAG;QAAC;kBAC5F,cAAA,qPAAC,qKAAK;YAAC,WAAW;YAAG,IAAI;gBAAC,OAAM;gBAAQ,UAAS;gBAAK,GAAE;gBAAG,cAAa;YAAC;;8BACvE,qPAAC,iKAAG;oBAAC,IAAI;wBAAC,WAAU;wBAAU,IAAG;oBAAC;;sCAChC,qPAAC,+KAAU;4BAAC,SAAQ;4BAAK,IAAI;gCAAC,YAAW;4BAAG;sCAAG;;;;;;sCAC/C,qPAAC,+KAAU;4BAAC,SAAQ;4BAAQ,OAAM;sCAAiB;;;;;;;;;;;;gBAGpD,uBAAS,qPAAC,qKAAK;oBAAC,UAAS;oBAAQ,IAAI;wBAAC,IAAG;oBAAC;8BAAI;;;;;;8BAE/C,qPAAC;oBAAK,UAAU;;sCACd,qPAAC,6KAAS;4BAAC,OAAM;4BAAO,OAAO;4BAAM,UAAU,CAAA,IAAG,QAAQ,EAAE,MAAM,CAAC,KAAK;4BAAG,SAAS;4BAAC,IAAI;gCAAC,IAAG;4BAAC;;;;;;sCAC9F,qPAAC,6KAAS;4BAAC,OAAM;4BAAW,MAAK;4BAAW,OAAO;4BAAU,UAAU,CAAA,IAAG,YAAY,EAAE,MAAM,CAAC,KAAK;4BAAG,SAAS;4BAAC,IAAI;gCAAC,IAAG;4BAAC;;;;;;sCAE1H,qPAAC,iKAAG;4BAAC,IAAI;gCAAC,SAAQ;gCAAQ,YAAW;gCAAU,gBAAe;gCAAiB,IAAG;4BAAC;;8CACjF,qPAAC,uKAAM;oCAAC,MAAK;oCAAS,SAAQ;oCAAY,UAAU;8CACjD,wBAAU,qPAAC,2LAAgB;wCAAC,MAAM;wCAAI,OAAM;;;;;+CAAe;;;;;;8CAE9D,qPAAC,uKAAM;oCAAC,SAAQ;oCAAO,SAAS,IAAI,OAAO,IAAI,CAAC;8CAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQlE"}}]
}