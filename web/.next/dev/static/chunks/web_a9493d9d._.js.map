{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/lib/api-client.ts"],"sourcesContent":["// lib/api-client.ts\r\nexport type ApiOptions = RequestInit & { body?: any };\r\n\r\nconst API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:4000/api';\r\n\r\nasync function handleResp(res: Response) {\r\n  const text = await res.text();\r\n  let data;\r\n  try { data = text ? JSON.parse(text) : undefined; } catch { data = text; }\r\n  if (!res.ok) {\r\n    const err: any = new Error(data?.message || res.statusText || 'API error');\r\n    err.status = res.status;\r\n    err.body = data;\r\n    throw err;\r\n  }\r\n  return data;\r\n}\r\n\r\nexport default async function apiClient(path: string, opts: ApiOptions = {}) {\r\n  const url = path.startsWith('http') ? path : `${API_BASE}${path.startsWith('/') ? '' : '/'}${path}`;\r\n\r\n  function getAuthHeader(): Record<string,string> {\r\n    try {\r\n      if (typeof window === 'undefined') return {};\r\n      const token = (localStorage.getItem('token') || '').trim();\r\n      return token ? { Authorization: `Bearer ${token}` } : {};\r\n    } catch (e) {\r\n      return {};\r\n    }\r\n  }\r\n\r\n  const headers: Record<string,string> = {\r\n    'Accept': 'application/json',\r\n    ...getAuthHeader(),\r\n    ...(opts.headers as Record<string,string> || {}),\r\n  };\r\n\r\n  let body: BodyInit | undefined;\r\n  if (opts.body !== undefined) {\r\n    headers['Content-Type'] = 'application/json';\r\n    body = JSON.stringify(opts.body);\r\n  }\r\n\r\n  try {\r\n    const res = await fetch(url, {\r\n      credentials: 'include',\r\n      ...opts,\r\n      headers,\r\n      body,\r\n    });\r\n    return await handleResp(res);\r\n  } catch (err: any) {\r\n    // If the error already comes from `handleResp` it may contain HTTP error details\r\n    // (status, body). Preserve those properties when rethrowing so callers can\r\n    // inspect `err.status` / `err.body` instead of losing them behind a wrapper.\r\n    if (err && (err as any).body !== undefined) {\r\n      // ensure url is available on the propagated error\r\n      try { (err as any).url = url; } catch (_) {}\r\n      throw err;\r\n    }\r\n\r\n    // Network-level error (CORS, DNS, connection refused, etc)\r\n    const e: any = new Error(err?.message || 'Network error');\r\n    e.detail = err;\r\n    e.url = url;\r\n    throw e;\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,oBAAoB;;;;;AAGH;AAAjB,MAAM,WAAW,kLAAO,CAAC,GAAG,CAAC,mBAAmB,IAAI;AAEpD,eAAe,WAAW,GAAa;IACrC,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,IAAI;IACJ,IAAI;QAAE,OAAO,OAAO,KAAK,KAAK,CAAC,QAAQ;IAAW,EAAE,OAAM;QAAE,OAAO;IAAM;IACzE,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,MAAW,IAAI,MAAM,MAAM,WAAW,IAAI,UAAU,IAAI;QAC9D,IAAI,MAAM,GAAG,IAAI,MAAM;QACvB,IAAI,IAAI,GAAG;QACX,MAAM;IACR;IACA,OAAO;AACT;AAEe,eAAe,UAAU,IAAY,EAAE,OAAmB,CAAC,CAAC;IACzE,MAAM,MAAM,KAAK,UAAU,CAAC,UAAU,OAAO,GAAG,WAAW,KAAK,UAAU,CAAC,OAAO,KAAK,MAAM,MAAM;IAEnG,SAAS;QACP,IAAI;YACF;;YACA,MAAM,QAAQ,CAAC,aAAa,OAAO,CAAC,YAAY,EAAE,EAAE,IAAI;YACxD,OAAO,QAAQ;gBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;YAAC,IAAI,CAAC;QACzD,EAAE,OAAO,GAAG;YACV,OAAO,CAAC;QACV;IACF;IAEA,MAAM,UAAiC;QACrC,UAAU;QACV,GAAG,eAAe;QAClB,GAAI,KAAK,OAAO,IAA6B,CAAC,CAAC;IACjD;IAEA,IAAI;IACJ,IAAI,KAAK,IAAI,KAAK,WAAW;QAC3B,OAAO,CAAC,eAAe,GAAG;QAC1B,OAAO,KAAK,SAAS,CAAC,KAAK,IAAI;IACjC;IAEA,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,KAAK;YAC3B,aAAa;YACb,GAAG,IAAI;YACP;YACA;QACF;QACA,OAAO,MAAM,WAAW;IAC1B,EAAE,OAAO,KAAU;QACjB,iFAAiF;QACjF,2EAA2E;QAC3E,6EAA6E;QAC7E,IAAI,OAAO,AAAC,IAAY,IAAI,KAAK,WAAW;YAC1C,kDAAkD;YAClD,IAAI;gBAAG,IAAY,GAAG,GAAG;YAAK,EAAE,OAAO,GAAG,CAAC;YAC3C,MAAM;QACR;QAEA,2DAA2D;QAC3D,MAAM,IAAS,IAAI,MAAM,KAAK,WAAW;QACzC,EAAE,MAAM,GAAG;QACX,EAAE,GAAG,GAAG;QACR,MAAM;IACR;AACF"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/components/WorkOrderForm.tsx"],"sourcesContent":["'use client';\r\nimport { useState } from 'react';\r\nimport apiClient from '../lib/api-client';\r\n\r\ntype Props = { onCreated?: () => void };\r\n\r\nexport default function WorkOrderForm({ onCreated }: Props) {\r\n  const [id, setId] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState<string | null>(null);\r\n\r\n  async function handleSubmit(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setMessage(null);\r\n    if (!id.trim()) return setMessage('Masukkan id SIGAP');\r\n    setLoading(true);\r\n    try {\r\n      const res = await apiClient('/work-orders/add', { method: 'POST', body: { id: id.trim() }});\r\n      setMessage('Work order tersimpan: ' + (res?.data?.doc_no || res?.data?.id || 'OK'));\r\n      setId('');\r\n      onCreated?.();\r\n    } catch (err: any) {\r\n      console.error('add error', err);\r\n      setMessage('Error: ' + (err.body?.detail || err.body?.message || err.message || 'gagal'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} style={{ display: 'flex', gap: 8, alignItems: 'center', marginBottom: 16 }}>\r\n      <input\r\n        value={id}\r\n        onChange={e => setId(e.target.value)}\r\n        placeholder=\"Masukkan id SIGAP (contoh: 1656)\"\r\n        disabled={loading}\r\n        style={{ padding: '8px 10px', minWidth: 260 }}\r\n      />\r\n      <button type=\"submit\" disabled={loading} style={{ padding: '8px 12px' }}>\r\n        {loading ? 'Mengambil...' : 'Ambil & Simpan'}\r\n      </button>\r\n      {message && <div style={{ marginLeft: 12 }}>{message}</div>}\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;;;AAFA;;;AAMe,SAAS,cAAc,EAAE,SAAS,EAAS;;IACxD,MAAM,CAAC,IAAI,MAAM,GAAG,IAAA,gLAAQ,EAAC;IAC7B,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gLAAQ,EAAC;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gLAAQ,EAAgB;IAEtD,eAAe,aAAa,CAAkB;QAC5C,EAAE,cAAc;QAChB,WAAW;QACX,IAAI,CAAC,GAAG,IAAI,IAAI,OAAO,WAAW;QAClC,WAAW;QACX,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,yIAAS,EAAC,oBAAoB;gBAAE,QAAQ;gBAAQ,MAAM;oBAAE,IAAI,GAAG,IAAI;gBAAG;YAAC;YACzF,WAAW,2BAA2B,CAAC,KAAK,MAAM,UAAU,KAAK,MAAM,MAAM,IAAI;YACjF,MAAM;YACN;QACF,EAAE,OAAO,KAAU;YACjB,QAAQ,KAAK,CAAC,aAAa;YAC3B,WAAW,YAAY,CAAC,IAAI,IAAI,EAAE,UAAU,IAAI,IAAI,EAAE,WAAW,IAAI,OAAO,IAAI,OAAO;QACzF,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,oMAAC;QAAK,UAAU;QAAc,OAAO;YAAE,SAAS;YAAQ,KAAK;YAAG,YAAY;YAAU,cAAc;QAAG;;0BACrG,oMAAC;gBACC,OAAO;gBACP,UAAU,CAAA,IAAK,MAAM,EAAE,MAAM,CAAC,KAAK;gBACnC,aAAY;gBACZ,UAAU;gBACV,OAAO;oBAAE,SAAS;oBAAY,UAAU;gBAAI;;;;;;0BAE9C,oMAAC;gBAAO,MAAK;gBAAS,UAAU;gBAAS,OAAO;oBAAE,SAAS;gBAAW;0BACnE,UAAU,iBAAiB;;;;;;YAE7B,yBAAW,oMAAC;gBAAI,OAAO;oBAAE,YAAY;gBAAG;0BAAI;;;;;;;;;;;;AAGnD;GAtCwB;KAAA"}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/app/work-orders/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport WorkOrderForm from '../../components/WorkOrderForm';\r\n// import WorkOrderList from '../../components/WorkOrderList';\r\nimport { useRef } from 'react';\r\n\r\nexport default function Page() {\r\n  // expose refresh function from list via ref\r\n  const refreshRef = useRef<(() => Promise<void>) | null>(null);\r\n  // const WorkOrderListAny = WorkOrderList as any;\r\n\r\n  return (\r\n    <main style={{ padding: 24, fontFamily: 'Inter, system-ui, -apple-system, Roboto, \"Helvetica Neue\", Arial' }}>\r\n      <h1 style={{ marginBottom: 12 }}>Work Orders</h1>\r\n\r\n      <section style={{ marginBottom: 20 }}>\r\n        <WorkOrderForm onCreated={() => refreshRef.current?.()} />\r\n      </section>\r\n\r\n      <section>\r\n        {/* <WorkOrderListAny onRefreshRequested={(fn: any) => { return refreshRef.current = fn; }} /> */}\r\n      </section>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA,8DAA8D;AAC9D;;;AAJA;;;AAMe,SAAS;;IACtB,4CAA4C;IAC5C,MAAM,aAAa,IAAA,8KAAM,EAA+B;IACxD,iDAAiD;IAEjD,qBACE,oMAAC;QAAK,OAAO;YAAE,SAAS;YAAI,YAAY;QAAmE;;0BACzG,oMAAC;gBAAG,OAAO;oBAAE,cAAc;gBAAG;0BAAG;;;;;;0BAEjC,oMAAC;gBAAQ,OAAO;oBAAE,cAAc;gBAAG;0BACjC,cAAA,oMAAC,iJAAa;oBAAC,WAAW,IAAM,WAAW,OAAO;;;;;;;;;;;0BAGpD,oMAAC;;;;;;;;;;;AAKP;GAlBwB;KAAA"}}]
}