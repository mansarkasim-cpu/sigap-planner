{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/lib/api-client.ts"],"sourcesContent":["// lib/api-client.ts\r\nexport type ApiOptions = RequestInit & { body?: any };\r\n\r\nconst API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:4000/api';\r\n\r\nasync function handleResp(res: Response) {\r\n  const text = await res.text();\r\n  let data;\r\n  try { data = text ? JSON.parse(text) : undefined; } catch { data = text; }\r\n  if (!res.ok) {\r\n    const err: any = new Error(data?.message || res.statusText || 'API error');\r\n    err.status = res.status;\r\n    err.body = data;\r\n    throw err;\r\n  }\r\n  return data;\r\n}\r\n\r\nexport default async function apiClient(path: string, opts: ApiOptions = {}) {\r\n  const url = path.startsWith('http') ? path : `${API_BASE}${path.startsWith('/') ? '' : '/'}${path}`;\r\n\r\n  function getAuthHeader(): Record<string,string> {\r\n    try {\r\n      if (typeof window === 'undefined') return {};\r\n      const token = (localStorage.getItem('token') || '').trim();\r\n      return token ? { Authorization: `Bearer ${token}` } : {};\r\n    } catch (e) {\r\n      return {};\r\n    }\r\n  }\r\n\r\n  const headers: Record<string,string> = {\r\n    'Accept': 'application/json',\r\n    ...getAuthHeader(),\r\n    ...(opts.headers as Record<string,string> || {}),\r\n  };\r\n\r\n  let body: BodyInit | undefined;\r\n  if (opts.body !== undefined) {\r\n    headers['Content-Type'] = 'application/json';\r\n    body = JSON.stringify(opts.body);\r\n  }\r\n\r\n  try {\r\n    const res = await fetch(url, {\r\n      credentials: 'include',\r\n      ...opts,\r\n      headers,\r\n      body,\r\n    });\r\n    return await handleResp(res);\r\n  } catch (err: any) {\r\n    // If the error already comes from `handleResp` it may contain HTTP error details\r\n    // (status, body). Preserve those properties when rethrowing so callers can\r\n    // inspect `err.status` / `err.body` instead of losing them behind a wrapper.\r\n    if (err && (err as any).body !== undefined) {\r\n      // ensure url is available on the propagated error\r\n      try { (err as any).url = url; } catch (_) {}\r\n      throw err;\r\n    }\r\n\r\n    // Network-level error (CORS, DNS, connection refused, etc)\r\n    const e: any = new Error(err?.message || 'Network error');\r\n    e.detail = err;\r\n    e.url = url;\r\n    throw e;\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,oBAAoB;;;;;AAGH;AAAjB,MAAM,WAAW,kLAAO,CAAC,GAAG,CAAC,mBAAmB,IAAI;AAEpD,eAAe,WAAW,GAAa;IACrC,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,IAAI;IACJ,IAAI;QAAE,OAAO,OAAO,KAAK,KAAK,CAAC,QAAQ;IAAW,EAAE,OAAM;QAAE,OAAO;IAAM;IACzE,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,MAAW,IAAI,MAAM,MAAM,WAAW,IAAI,UAAU,IAAI;QAC9D,IAAI,MAAM,GAAG,IAAI,MAAM;QACvB,IAAI,IAAI,GAAG;QACX,MAAM;IACR;IACA,OAAO;AACT;AAEe,eAAe,UAAU,IAAY,EAAE,OAAmB,CAAC,CAAC;IACzE,MAAM,MAAM,KAAK,UAAU,CAAC,UAAU,OAAO,GAAG,WAAW,KAAK,UAAU,CAAC,OAAO,KAAK,MAAM,MAAM;IAEnG,SAAS;QACP,IAAI;YACF;;YACA,MAAM,QAAQ,CAAC,aAAa,OAAO,CAAC,YAAY,EAAE,EAAE,IAAI;YACxD,OAAO,QAAQ;gBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;YAAC,IAAI,CAAC;QACzD,EAAE,OAAO,GAAG;YACV,OAAO,CAAC;QACV;IACF;IAEA,MAAM,UAAiC;QACrC,UAAU;QACV,GAAG,eAAe;QAClB,GAAI,KAAK,OAAO,IAA6B,CAAC,CAAC;IACjD;IAEA,IAAI;IACJ,IAAI,KAAK,IAAI,KAAK,WAAW;QAC3B,OAAO,CAAC,eAAe,GAAG;QAC1B,OAAO,KAAK,SAAS,CAAC,KAAK,IAAI;IACjC;IAEA,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,KAAK;YAC3B,aAAa;YACb,GAAG,IAAI;YACP;YACA;QACF;QACA,OAAO,MAAM,WAAW;IAC1B,EAAE,OAAO,KAAU;QACjB,iFAAiF;QACjF,2EAA2E;QAC3E,6EAA6E;QAC7E,IAAI,OAAO,AAAC,IAAY,IAAI,KAAK,WAAW;YAC1C,kDAAkD;YAClD,IAAI;gBAAG,IAAY,GAAG,GAAG;YAAK,EAAE,OAAO,GAAG,CAAC;YAC3C,MAAM;QACR;QAEA,2DAA2D;QAC3D,MAAM,IAAS,IAAI,MAAM,KAAK,WAAW;QACzC,EAAE,MAAM,GAAG;QACX,EAAE,GAAG,GAAG;QACR,MAAM;IACR;AACF"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/app/login/page.jsx"],"sourcesContent":["'use client';\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport apiClient from '../../lib/api-client';\r\n\r\nexport default function LoginPage() {\r\n  const [nipp, setNipp] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const router = useRouter();\r\n\r\n  async function submit(e) {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const res = await apiClient('/auth/login', { method: 'POST', body: { nipp, password } });\r\n      // expected response: { accessToken, user }\r\n      const token = res?.accessToken || res?.token || res?.access_token;\r\n      if (!token) {\r\n        setError('Login succeeded but no token returned');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      // store token in localStorage under 'token'\r\n      try { localStorage.setItem('token', token); } catch (e) { }\r\n      // redirect to work orders\r\n      router.push('/work-orders');\r\n    } catch (err) {\r\n      console.error('login failed', err);\r\n      setError(err?.body?.message || err?.message || 'Login failed');\r\n    } finally { setLoading(false); }\r\n  }\r\n\r\n  return (\r\n    <div style={{ padding:16, maxWidth:640, margin:'0 auto' }}>\r\n      <h2>Login</h2>\r\n      <form onSubmit={submit} style={{ display:'flex', flexDirection:'column', gap:8 }}>\r\n        <label>\r\n          NIPP\r\n          <input value={nipp} onChange={e=>setNipp(e.target.value)} style={{ width:'100%', padding:8 }} />\r\n        </label>\r\n\r\n        <label>\r\n          Password\r\n          <input type=\"password\" value={password} onChange={e=>setPassword(e.target.value)} style={{ width:'100%', padding:8 }} />\r\n        </label>\r\n\r\n        {error && <div style={{ color:'red' }}>{String(error)}</div>}\r\n\r\n        <div style={{ display:'flex', gap:8 }}>\r\n          <button type=\"submit\" disabled={loading} style={{ padding:'8px 16px' }}>{loading ? 'Logging...' : 'Login'}</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;AAHA;;;;AAKe,SAAS;;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,gLAAQ,EAAC;IACjC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,gLAAQ,EAAC;IACzC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gLAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gLAAQ,EAAC;IACnC,MAAM,SAAS,IAAA,yJAAS;IAExB,eAAe,OAAO,CAAC;QACrB,EAAE,cAAc;QAChB,WAAW;QACX,SAAS;QACT,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,yIAAS,EAAC,eAAe;gBAAE,QAAQ;gBAAQ,MAAM;oBAAE;oBAAM;gBAAS;YAAE;YACtF,2CAA2C;YAC3C,MAAM,QAAQ,KAAK,eAAe,KAAK,SAAS,KAAK;YACrD,IAAI,CAAC,OAAO;gBACV,SAAS;gBACT,WAAW;gBACX;YACF;YACA,4CAA4C;YAC5C,IAAI;gBAAE,aAAa,OAAO,CAAC,SAAS;YAAQ,EAAE,OAAO,GAAG,CAAE;YAC1D,0BAA0B;YAC1B,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,gBAAgB;YAC9B,SAAS,KAAK,MAAM,WAAW,KAAK,WAAW;QACjD,SAAU;YAAE,WAAW;QAAQ;IACjC;IAEA,qBACE,oMAAC;QAAI,OAAO;YAAE,SAAQ;YAAI,UAAS;YAAK,QAAO;QAAS;;0BACtD,oMAAC;0BAAG;;;;;;0BACJ,oMAAC;gBAAK,UAAU;gBAAQ,OAAO;oBAAE,SAAQ;oBAAQ,eAAc;oBAAU,KAAI;gBAAE;;kCAC7E,oMAAC;;4BAAM;0CAEL,oMAAC;gCAAM,OAAO;gCAAM,UAAU,CAAA,IAAG,QAAQ,EAAE,MAAM,CAAC,KAAK;gCAAG,OAAO;oCAAE,OAAM;oCAAQ,SAAQ;gCAAE;;;;;;;;;;;;kCAG7F,oMAAC;;4BAAM;0CAEL,oMAAC;gCAAM,MAAK;gCAAW,OAAO;gCAAU,UAAU,CAAA,IAAG,YAAY,EAAE,MAAM,CAAC,KAAK;gCAAG,OAAO;oCAAE,OAAM;oCAAQ,SAAQ;gCAAE;;;;;;;;;;;;oBAGpH,uBAAS,oMAAC;wBAAI,OAAO;4BAAE,OAAM;wBAAM;kCAAI,OAAO;;;;;;kCAE/C,oMAAC;wBAAI,OAAO;4BAAE,SAAQ;4BAAQ,KAAI;wBAAE;kCAClC,cAAA,oMAAC;4BAAO,MAAK;4BAAS,UAAU;4BAAS,OAAO;gCAAE,SAAQ;4BAAW;sCAAI,UAAU,eAAe;;;;;;;;;;;;;;;;;;;;;;;AAK5G;GApDwB;;QAKP,yJAAS;;;KALF"}},
    {"offset": {"line": 261, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}}]
}