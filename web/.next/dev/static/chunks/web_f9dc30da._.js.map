{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/app/MuiProviders.jsx"],"sourcesContent":["'use client'\r\nimport { ThemeProvider, createTheme } from '@mui/material/styles'\r\nimport CssBaseline from '@mui/material/CssBaseline'\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: { main: '#7c3aed' },\r\n    secondary: { main: '#6d28d9' },\r\n    background: { default: '#fafafa', paper: '#fff' },\r\n  },\r\n  typography: {\r\n    fontFamily: \"Inter, Roboto, 'Helvetica Neue', Arial\",\r\n  },\r\n  shape: { borderRadius: 12 },\r\n})\r\n\r\nexport default function MuiProviders({ children }){\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CssBaseline />\r\n      {children}\r\n    </ThemeProvider>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AAAA;AACA;AAFA;;;;AAIA,MAAM,QAAQ,IAAA,6NAAW,EAAC;IACxB,SAAS;QACP,SAAS;YAAE,MAAM;QAAU;QAC3B,WAAW;YAAE,MAAM;QAAU;QAC7B,YAAY;YAAE,SAAS;YAAW,OAAO;QAAO;IAClD;IACA,YAAY;QACV,YAAY;IACd;IACA,OAAO;QAAE,cAAc;IAAG;AAC5B;AAEe,SAAS,aAAa,EAAE,QAAQ,EAAE;IAC/C,qBACE,oMAAC,mOAAa;QAAC,OAAO;;0BACpB,oMAAC,oLAAW;;;;;YACX;;;;;;;AAGP;KAPwB"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/components/RouteGuard.jsx"],"sourcesContent":["\"use client\"\r\nimport { useEffect } from 'react'\r\nimport { usePathname, useRouter } from 'next/navigation'\r\n\r\nexport default function RouteGuard(){\r\n  const pathname = usePathname()\r\n  const router = useRouter()\r\n\r\n  useEffect(()=>{\r\n    if (typeof window === 'undefined') return\r\n    const token = localStorage.getItem('token')\r\n    // allow unauthenticated access to public pages\r\n    const publicPaths = ['/login','/']\r\n    if (publicPaths.some(p => pathname === p)) return\r\n\r\n    // For all other pages, require token\r\n    if (!token) router.push('/login')\r\n  }, [pathname, router])\r\n\r\n  return null\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;;AAFA;;;AAIe,SAAS;;IACtB,MAAM,WAAW,IAAA,2JAAW;IAC5B,MAAM,SAAS,IAAA,yJAAS;IAExB,IAAA,iLAAS;gCAAC;YACR;;YACA,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,+CAA+C;YAC/C,MAAM,cAAc;gBAAC;gBAAS;aAAI;YAClC,IAAI,YAAY,IAAI;wCAAC,CAAA,IAAK,aAAa;wCAAI;YAE3C,qCAAqC;YACrC,IAAI,CAAC,OAAO,OAAO,IAAI,CAAC;QAC1B;+BAAG;QAAC;QAAU;KAAO;IAErB,OAAO;AACT;GAhBwB;;QACL,2JAAW;QACb,yJAAS;;;KAFF"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/components/AuthButton.jsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useState } from 'react';\r\nimport Link from 'next/link';\r\nimport LogoutIcon from '@mui/icons-material/Logout';\r\n\r\nexport default function AuthButton() {\r\n  const [token, setToken] = useState(null);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const t = localStorage.getItem('token');\r\n      setToken(t);\r\n    } catch (e) {\r\n      setToken(null);\r\n    }\r\n  }, []);\r\n\r\n  function logout() {\r\n    try { localStorage.removeItem('token'); } catch (e) {}\r\n    try { localStorage.removeItem('sigap_user'); } catch (e) {}\r\n    try { localStorage.removeItem('sigap_role'); } catch (e) {}\r\n    try { document.cookie = 'token=; Path=/; Max-Age=0' } catch (e) {}\r\n    try { document.cookie = 'sigap_user=; Path=/; Max-Age=0' } catch (e) {}\r\n    try { document.cookie = 'sigap_role=; Path=/; Max-Age=0' } catch (e) {}\r\n    // force reload so client components re-evaluate auth state\r\n    if (typeof window !== 'undefined') window.location.reload();\r\n  }\r\n\r\n  if (token) {\r\n    return (\r\n      <button onClick={logout} title=\"Logout\" aria-label=\"Logout\" style={{ background: 'transparent', border: 'none', cursor: 'pointer', padding: 0 }} className=\"nav-link\">\r\n        <LogoutIcon style={{ fontSize: 18 }} />\r\n      </button>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Link href=\"/login\" className=\"nav-link\">Login</Link>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;AAHA;;;;AAKe,SAAS;;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gLAAQ,EAAC;IAEnC,IAAA,iLAAS;gCAAC;YACR,IAAI;gBACF,MAAM,IAAI,aAAa,OAAO,CAAC;gBAC/B,SAAS;YACX,EAAE,OAAO,GAAG;gBACV,SAAS;YACX;QACF;+BAAG,EAAE;IAEL,SAAS;QACP,IAAI;YAAE,aAAa,UAAU,CAAC;QAAU,EAAE,OAAO,GAAG,CAAC;QACrD,IAAI;YAAE,aAAa,UAAU,CAAC;QAAe,EAAE,OAAO,GAAG,CAAC;QAC1D,IAAI;YAAE,aAAa,UAAU,CAAC;QAAe,EAAE,OAAO,GAAG,CAAC;QAC1D,IAAI;YAAE,SAAS,MAAM,GAAG;QAA4B,EAAE,OAAO,GAAG,CAAC;QACjE,IAAI;YAAE,SAAS,MAAM,GAAG;QAAiC,EAAE,OAAO,GAAG,CAAC;QACtE,IAAI;YAAE,SAAS,MAAM,GAAG;QAAiC,EAAE,OAAO,GAAG,CAAC;QACtE,2DAA2D;QAC3D,wCAAmC,OAAO,QAAQ,CAAC,MAAM;IAC3D;IAEA,IAAI,OAAO;QACT,qBACE,oMAAC;YAAO,SAAS;YAAQ,OAAM;YAAS,cAAW;YAAS,OAAO;gBAAE,YAAY;gBAAe,QAAQ;gBAAQ,QAAQ;gBAAW,SAAS;YAAE;YAAG,WAAU;sBACzJ,cAAA,oMAAC,yKAAU;gBAAC,OAAO;oBAAE,UAAU;gBAAG;;;;;;;;;;;IAGxC;IAEA,qBACE,oMAAC,iLAAI;QAAC,MAAK;QAAS,WAAU;kBAAW;;;;;;AAE7C;GAlCwB;KAAA"}},
    {"offset": {"line": 212, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/lib/api-client.ts"],"sourcesContent":["// lib/api-client.ts\r\nexport type ApiOptions = RequestInit & { body?: any };\r\n\r\nexport type ApiLog = {\r\n  id: string;\r\n  ts: number;\r\n  method: string;\r\n  url: string;\r\n  reqBody?: any;\r\n  resStatus?: number;\r\n  resBody?: any;\r\n  error?: string;\r\n  durationMs?: number;\r\n};\r\n\r\nexport function getApiLogs(): ApiLog[] {\r\n  try {\r\n    // @ts-ignore\r\n    return (typeof window !== 'undefined' && window.__apiLogs) ? window.__apiLogs.slice() : [];\r\n  } catch (_) { return []; }\r\n}\r\n\r\nexport function clearApiLogs() {\r\n  try {\r\n    // @ts-ignore\r\n    if (typeof window !== 'undefined') window.__apiLogs = [];\r\n  } catch (_) {}\r\n}\r\n\r\nconst API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:4000/api';\r\n\r\nasync function handleResp(res: Response) {\r\n  const text = await res.text();\r\n  let data;\r\n  try { data = text ? JSON.parse(text) : undefined; } catch { data = text; }\r\n  if (!res.ok) {\r\n    const err: any = new Error(data?.message || res.statusText || 'API error');\r\n    err.status = res.status;\r\n    err.body = data;\r\n    throw err;\r\n  }\r\n  return data;\r\n}\r\n\r\nexport default async function apiClient(path: string, opts?: RequestInit) {\r\n  const url = path.startsWith('http') ? path : `${API_BASE}${path.startsWith('/') ? '' : '/'}${path}`;\r\n\r\n  function getAuthHeader(): Record<string,string> {\r\n    try {\r\n      if (typeof window === 'undefined') return {};\r\n      const token = (localStorage.getItem('token') || '').trim();\r\n      return token ? { Authorization: `Bearer ${token}` } : {};\r\n    } catch (e) {\r\n      return {};\r\n    }\r\n  }\r\n\r\n  // normalize options\r\n  const init: RequestInit = { ...(opts || {}) };\r\n\r\n  // ensure headers object\r\n  // include auth header from localStorage by default, but allow explicit headers in `opts` to override\r\n  const headers = Object.assign({}, getAuthHeader(), (init.headers as Record<string,string>) || {});\r\n\r\n  // if body is a plain object (not string / FormData / Blob), stringify it and set JSON header\r\n  const isFormData = typeof FormData !== 'undefined' && init.body instanceof FormData;\r\n  const isBlob = typeof Blob !== 'undefined' && init.body instanceof Blob;\r\n  if (init.body != null && typeof init.body !== 'string' && !isFormData && !isBlob) {\r\n      headers['Content-Type'] = headers['Content-Type'] || 'application/json';\r\n      init.body = JSON.stringify(init.body) as unknown as BodyInit;\r\n  } else {\r\n      // if body already a string, don't re-stringify; ensure Content-Type if not set and body exists\r\n      if (init.body != null && typeof init.body === 'string') {\r\n          headers['Content-Type'] = headers['Content-Type'] || 'application/json';\r\n      }\r\n  }\r\n\r\n  init.headers = headers;\r\n\r\n  let res: Response | undefined;\r\n  // prepare logging\r\n  const startTs = Date.now();\r\n  const logEntry: ApiLog = { id: String(startTs) + '-' + Math.random().toString(36).slice(2,8), ts: startTs, method: (init.method || 'GET').toString().toUpperCase(), url, reqBody: undefined };\r\n  try {\r\n    try { logEntry.reqBody = init.body ? (typeof init.body === 'string' ? JSON.parse(init.body as string) : init.body) : undefined; } catch (_) { logEntry.reqBody = init.body; }\r\n    // ensure window log buffer\r\n    try {\r\n      // @ts-ignore\r\n      if (typeof window !== 'undefined') window.__apiLogs = window.__apiLogs || [];\r\n    } catch (_) {}\r\n    // console log request\r\n    try { console.debug('[api] ->', logEntry.method, url, logEntry.reqBody ? { body: logEntry.reqBody } : {}); } catch (_) {}\r\n\r\n    // emit loading start (maintain a counter on window to support concurrent requests)\r\n    try {\r\n      if (typeof window !== 'undefined') {\r\n        // @ts-ignore\r\n        window.__apiLoadingCounter = (window.__apiLoadingCounter || 0) + 1;\r\n        // @ts-ignore\r\n        window.dispatchEvent(new CustomEvent('api-loading', { detail: { count: window.__apiLoadingCounter } }));\r\n      }\r\n    } catch (_) {}\r\n    res = await fetch(url, {\r\n      credentials: 'include',\r\n      ...opts,\r\n      headers,\r\n      body: init.body,\r\n    });\r\n    const result = await handleResp(res);\r\n    logEntry.resStatus = res.status;\r\n    logEntry.resBody = result;\r\n    logEntry.durationMs = Date.now() - startTs;\r\n    try {\r\n      // @ts-ignore\r\n      if (typeof window !== 'undefined') {\r\n        // @ts-ignore\r\n        window.__apiLogs.push(logEntry);\r\n        // cap logs\r\n        // @ts-ignore\r\n        if (window.__apiLogs.length > 200) window.__apiLogs.shift();\r\n      }\r\n    } catch (_) {}\r\n    try { console.debug('[api] <-', logEntry.method, url, { status: logEntry.resStatus, durationMs: logEntry.durationMs }); } catch (_) {}\r\n    return result;\r\n  } catch (err: any) {\r\n    // log error info\r\n    try {\r\n      if (err && (err as any).body !== undefined) {\r\n        logEntry.resStatus = (err as any).status;\r\n        logEntry.resBody = (err as any).body;\r\n        logEntry.error = err.message;\r\n      } else {\r\n        logEntry.error = err?.message || String(err);\r\n      }\r\n      logEntry.durationMs = Date.now() - startTs;\r\n      try {\r\n        // @ts-ignore\r\n        if (typeof window !== 'undefined') {\r\n          // @ts-ignore\r\n          window.__apiLogs.push(logEntry);\r\n          // @ts-ignore\r\n          if (window.__apiLogs.length > 200) window.__apiLogs.shift();\r\n        }\r\n      } catch (_) {}\r\n      try { console.debug('[api] x<-', logEntry.method, url, { error: logEntry.error }); } catch (_) {}\r\n    } catch (_) {}\r\n\r\n    // If the error already comes from `handleResp` it may contain HTTP error details\r\n    if (err && (err as any).body !== undefined) {\r\n      try { (err as any).url = url; } catch (_) {}\r\n      throw err;\r\n    }\r\n    const e: any = new Error(err?.message || 'Network error');\r\n    e.detail = err;\r\n    e.url = url;\r\n    throw e;\r\n  } finally {\r\n    try {\r\n      if (typeof window !== 'undefined') {\r\n        // @ts-ignore\r\n        window.__apiLoadingCounter = Math.max(0, (window.__apiLoadingCounter || 1) - 1);\r\n        // @ts-ignore\r\n        window.dispatchEvent(new CustomEvent('api-loading', { detail: { count: window.__apiLoadingCounter } }));\r\n      }\r\n    } catch (_) {}\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 413, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/components/Nav.jsx"],"sourcesContent":["\"use client\"\r\nimport Link from 'next/link'\r\nimport { usePathname } from 'next/navigation'\r\nimport AuthButton from './AuthButton'\r\nimport { useEffect, useState } from 'react'\r\nimport apiClient from '../lib/api-client'\r\n\r\nfunction isAdminRole(raw) {\r\n  if (!raw) return false\r\n  try {\r\n    if (typeof raw === 'string') {\r\n      // maybe a JSON string\r\n      if (raw.startsWith('[') || raw.startsWith('{')) {\r\n        const parsed = JSON.parse(raw)\r\n        if (Array.isArray(parsed)) return parsed.map(String).some(r => r.toLowerCase() === 'admin')\r\n        if (typeof parsed === 'string') return parsed.toLowerCase() === 'admin'\r\n        if (parsed && parsed.role) return String(parsed.role).toLowerCase() === 'admin'\r\n      }\r\n      return raw.toLowerCase() === 'admin'\r\n    }\r\n    if (Array.isArray(raw)) return raw.map(String).some(r => r.toLowerCase() === 'admin')\r\n    if (typeof raw === 'object') {\r\n      if (raw.role) return String(raw.role).toLowerCase() === 'admin'\r\n    }\r\n  } catch (e) {}\r\n  return false\r\n}\r\n\r\nexport default function Nav(){\r\n  const pathname = usePathname()\r\n  const [isAdmin, setIsAdmin] = useState(false)\r\n\r\n  useEffect(()=>{\r\n    let mounted = true\r\n    async function loadRole(){\r\n      try{\r\n        let raw = localStorage.getItem('sigap_role')\r\n        if (!raw){\r\n          const token = localStorage.getItem('token')\r\n          if (token){\r\n            // try server-side /auth/me to get role\r\n            try{\r\n              const me = await apiClient('/auth/me')\r\n              const roleVal = me?.role || (me?.user && me.user.role) || null\r\n              if (roleVal) {\r\n                const roleStr = typeof roleVal === 'string' ? roleVal : JSON.stringify(roleVal)\r\n                localStorage.setItem('sigap_role', roleStr)\r\n                raw = roleStr\r\n              }\r\n            }catch(e){/* ignore */}\r\n          }\r\n        }\r\n        if (mounted) setIsAdmin(isAdminRole(raw))\r\n      }catch(e){ if (mounted) setIsAdmin(false) }\r\n    }\r\n    loadRole()\r\n    return ()=>{ mounted = false }\r\n  }, [])\r\n\r\n  // hide nav on login page\r\n  if (typeof pathname === 'string' && pathname === '/login') return null\r\n\r\n  return (\r\n    <nav className=\"nav\">\r\n      <ul className=\"nav-menu\">\r\n        <li className=\"nav-item\"><Link href=\"/dashboard\" className=\"nav-link\">Dashboard</Link></li>\r\n\r\n        {isAdmin && (\r\n          <li className=\"nav-item has-sub\">\r\n            <span className=\"nav-link\">Master</span>\r\n            <ul className=\"sub-menu\">\r\n              <li><Link href=\"/users\" className=\"nav-link\">Users</Link></li>\r\n            </ul>\r\n          </li>\r\n        )}\r\n\r\n        <li className=\"nav-item has-sub\">\r\n          <span className=\"nav-link\">Konfigurasi</span>\r\n          <ul className=\"sub-menu\">\r\n            <li><Link href=\"/shifts\" className=\"nav-link\">Shift</Link></li>\r\n          </ul>\r\n        </li>\r\n\r\n        <li className=\"nav-item has-sub\">\r\n          <span className=\"nav-link\">Work Order</span>\r\n          <ul className=\"sub-menu\">\r\n            <li><Link href=\"/work-orders\" className=\"nav-link\">List</Link></li>\r\n            <li><Link href=\"/gantt\" className=\"nav-link\">Gantt Chart</Link></li>\r\n            <li><Link href=\"/realisasi\" className=\"nav-link\">Realisasi</Link></li>\r\n          </ul>\r\n        </li>\r\n\r\n        <li className=\"nav-item auth-item\"><AuthButton /></li>\r\n      </ul>\r\n    </nav>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 700, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/components/LoadingOverlay.jsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Backdrop, CircularProgress } from '@mui/material';\r\n\r\nexport default function LoadingOverlay() {\r\n  const [open, setOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    function handle(e) {\r\n      let count = 0;\r\n      if (e && e.detail && typeof e.detail.count === 'number') count = e.detail.count;\r\n      else {\r\n        try {\r\n          if (typeof window !== 'undefined') count = Number(window.__apiLoadingCounter || 0);\r\n        } catch (_) { count = 0; }\r\n      }\r\n      setOpen(Boolean(count && count > 0));\r\n    }\r\n    // initialize\r\n    try {\r\n      const init = (typeof window !== 'undefined') ? Number(window.__apiLoadingCounter || 0) : 0;\r\n      setOpen(init > 0);\r\n    } catch (_) {}\r\n    window.addEventListener('api-loading', handle);\r\n    return () => window.removeEventListener('api-loading', handle);\r\n  }, []);\r\n\r\n  return (\r\n    <Backdrop open={open} sx={{ zIndex: 1400, color: '#fff' }}>\r\n      <CircularProgress color=\"inherit\" />\r\n    </Backdrop>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;;;AAFA;;;AAIe,SAAS;;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,gLAAQ,EAAC;IAEjC,IAAA,iLAAS;oCAAC;YACR,SAAS,OAAO,CAAC;gBACf,IAAI,QAAQ;gBACZ,IAAI,KAAK,EAAE,MAAM,IAAI,OAAO,EAAE,MAAM,CAAC,KAAK,KAAK,UAAU,QAAQ,EAAE,MAAM,CAAC,KAAK;qBAC1E;oBACH,IAAI;wBACF,wCAAmC,QAAQ,OAAO,OAAO,mBAAmB,IAAI;oBAClF,EAAE,OAAO,GAAG;wBAAE,QAAQ;oBAAG;gBAC3B;gBACA,QAAQ,QAAQ,SAAS,QAAQ;YACnC;YACA,aAAa;YACb,IAAI;gBACF,MAAM,OAAO,uCAAkC,OAAO,OAAO,mBAAmB,IAAI,KAAK;gBACzF,QAAQ,OAAO;YACjB,EAAE,OAAO,GAAG,CAAC;YACb,OAAO,gBAAgB,CAAC,eAAe;YACvC;4CAAO,IAAM,OAAO,mBAAmB,CAAC,eAAe;;QACzD;mCAAG,EAAE;IAEL,qBACE,oMAAC,sNAAQ;QAAC,MAAM;QAAM,IAAI;YAAE,QAAQ;YAAM,OAAO;QAAO;kBACtD,cAAA,oMAAC,sPAAgB;YAAC,OAAM;;;;;;;;;;;AAG9B;GA5BwB;KAAA"}}]
}