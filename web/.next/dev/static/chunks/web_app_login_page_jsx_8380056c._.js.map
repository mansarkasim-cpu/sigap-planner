{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/SigapPlanner/web/app/login/page.jsx"],"sourcesContent":["\"use client\"\r\nimport { useState, useEffect } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport Box from '@mui/material/Box'\r\nimport Paper from '@mui/material/Paper'\r\nimport TextField from '@mui/material/TextField'\r\nimport Button from '@mui/material/Button'\r\nimport Typography from '@mui/material/Typography'\r\nimport Alert from '@mui/material/Alert'\r\nimport CircularProgress from '@mui/material/CircularProgress'\r\nimport Checkbox from '@mui/material/Checkbox'\r\nimport FormControlLabel from '@mui/material/FormControlLabel'\r\nimport InputAdornment from '@mui/material/InputAdornment'\r\nimport IconButton from '@mui/material/IconButton'\r\nimport apiClient from '../../lib/api-client'\r\n\r\nexport default function LoginPage(){\r\n  const router = useRouter()\r\n  useEffect(() => {\r\n    try {\r\n      const t = typeof window !== 'undefined' ? localStorage.getItem('token') : null\r\n      if (t) router.replace('/dashboard')\r\n      // prefill nipp if user chose remember me\r\n      const remembered = typeof window !== 'undefined' ? localStorage.getItem('remember_nipp') : null\r\n      if (remembered) {\r\n        setNipp(remembered)\r\n        setRememberMe(true)\r\n      }\r\n    } catch (e) {}\r\n  }, [router])\r\n  const [nipp, setNipp] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [rememberMe, setRememberMe] = useState(false)\r\n  const [showPassword, setShowPassword] = useState(false)\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState('')\r\n\r\n  async function handleSubmit(e){\r\n    e.preventDefault()\r\n    setError('')\r\n    setLoading(true)\r\n    try{\r\n      // POST to auth login endpoint (resolves to /api/auth/login via API_BASE)\r\n      const res = await apiClient('/auth/login', { method: 'POST', body: { nipp, password } })\r\n      const token = res?.accessToken || res?.token || res?.access_token\r\n      if (!token) throw new Error('No token returned')\r\n      try { localStorage.setItem('token', token) } catch (e) {}\r\n      try { document.cookie = `token=${token}; Path=/; SameSite=Lax` } catch (e) {}\r\n      // persist remembered nipp\r\n      try {\r\n        if (rememberMe) {\r\n          localStorage.setItem('remember_nipp', nipp)\r\n        } else {\r\n          localStorage.removeItem('remember_nipp')\r\n        }\r\n      } catch (e) {}\r\n      try {\r\n        const name = res?.user?.name || res?.user?.username || res?.user?.nipp || nipp\r\n        if (name) {\r\n          localStorage.setItem('sigap_user', name)\r\n          try { document.cookie = `sigap_user=${encodeURIComponent(name)}; Path=/; SameSite=Lax` } catch (e) {}\r\n        }\r\n        // persist role information if present\r\n        const role = res?.user?.role || res?.user?.roles || res?.roles\r\n        if (role) {\r\n          // store as JSON string when array/object\r\n          const roleValue = typeof role === 'string' ? role : JSON.stringify(role)\r\n          try { localStorage.setItem('sigap_role', roleValue) } catch (e) {}\r\n          try { document.cookie = `sigap_role=${encodeURIComponent(roleValue)}; Path=/; SameSite=Lax` } catch (e) {}\r\n        }\r\n      } catch (e) {}\r\n      router.replace('/dashboard')\r\n    }catch(err){\r\n      console.error('login error', err)\r\n      setError(err?.message || 'Login failed')\r\n    }finally{ setLoading(false) }\r\n  }\r\n\r\n  return (\r\n    <Box sx={{minHeight:'70vh', display:'flex', alignItems:'center', justifyContent:'center', py:6}}>\r\n      <Paper elevation={6} sx={{width:'100%', maxWidth:480, p:4, borderRadius:2}}>\r\n        <Box sx={{textAlign:'center', mb:2}}>\r\n          {/* Inline simple logo representing port equipment + gear */}\r\n          <Box sx={{display:'flex', alignItems:'center', justifyContent:'center', mb:1}}>\r\n            <svg width=\"84\" height=\"84\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden>\r\n              <rect width=\"64\" height=\"64\" rx=\"8\" fill=\"#0B74DE\" />\r\n              <g transform=\"translate(6,6)\" fill=\"none\" stroke=\"none\">\r\n                {/* container */}\r\n                <rect x=\"8\" y=\"30\" width=\"40\" height=\"12\" rx=\"1.5\" fill=\"#fff\" />\r\n                <rect x=\"12\" y=\"34\" width=\"12\" height=\"6\" fill=\"#0B74DE\" />\r\n                <rect x=\"28\" y=\"34\" width=\"12\" height=\"6\" fill=\"#0B74DE\" />\r\n\r\n                {/* crane boom */}\r\n                <rect x=\"36\" y=\"6\" width=\"3\" height=\"28\" rx=\"1\" fill=\"#fff\" transform=\"rotate(18 36 6)\" />\r\n                <rect x=\"28\" y=\"8\" width=\"18\" height=\"3\" rx=\"1\" fill=\"#fff\" transform=\"rotate(18 28 8)\" />\r\n\r\n                {/* hook / cable */}\r\n                <path d=\"M48 28 v8 c0 1 -1 2 -2 2 h-6\" stroke=\"#fff\" strokeWidth=\"1.6\" strokeLinecap=\"round\" strokeLinejoin=\"round\" fill=\"none\" />\r\n\r\n                {/* gear symbol (white circle with blue gear strokes) */}\r\n                <circle cx=\"18\" cy=\"18\" r=\"7\" fill=\"#fff\" />\r\n                <g stroke=\"#0B74DE\" strokeWidth=\"1.1\" strokeLinecap=\"round\">\r\n                  <path d=\"M18 11 v-2\" />\r\n                  <path d=\"M18 25 v2\" />\r\n                  <path d=\"M25 18 h2\" />\r\n                  <path d=\"M11 18 h-2\" />\r\n                  <path d=\"M23 13 l1.4 -1.4\" />\r\n                  <path d=\"M13 23 l-1.4 1.4\" />\r\n                  <path d=\"M23 23 l1.4 1.4\" />\r\n                  <path d=\"M13 13 l-1.4 -1.4\" />\r\n                </g>\r\n              </g>\r\n            </svg>\r\n          </Box>\r\n          <Typography variant=\"h5\" sx={{fontWeight:700}}>SigapPlanner</Typography>\r\n          <Typography variant=\"body2\" color=\"text.secondary\">Masuk untuk melanjutkan ke Planner</Typography>\r\n        </Box>\r\n\r\n        {error && <Alert severity=\"error\" sx={{mb:2}}>{error}</Alert>}\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <TextField label=\"NIPP\" value={nipp} onChange={e=>setNipp(e.target.value)} fullWidth sx={{mb:2}} />\r\n          <TextField\r\n            label=\"Password\"\r\n            type={showPassword ? 'text' : 'password'}\r\n            value={password}\r\n            onChange={e=>setPassword(e.target.value)}\r\n            fullWidth\r\n            sx={{mb:2}}\r\n            inputProps={{ autoComplete: 'current-password' }}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton aria-label={showPassword ? 'Sembunyikan kata sandi' : 'Tampilkan kata sandi'} onClick={()=>setShowPassword(s=>!s)} edge=\"end\">\r\n                    {showPassword ? (\r\n                      <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M12 5C7 5 2.7 8.1 1 12c1.7 3.9 6 7 11 7s9.3-3.1 11-7c-1.7-3.9-6-7-11-7zm0 12a5 5 0 110-10 5 5 0 010 10z\" fill=\"#000\"/></svg>\r\n                    ) : (\r\n                      <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M2 2l20 20-1.4 1.4L16 17.8A9.5 9.5 0 0112 19c-5 0-9.3-3.1-11-7 1.1-2.5 2.9-4.6 5-6.1L3.4 3.4 2 2z\" fill=\"#000\"/></svg>\r\n                    )}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n\r\n          <Box sx={{display:'flex', alignItems:'center', justifyContent:'space-between', mb:1}}>\r\n            <FormControlLabel control={<Checkbox checked={rememberMe} onChange={e=>setRememberMe(e.target.checked)} />} label=\"Ingat saya\" />\r\n          </Box>\r\n\r\n          <Box sx={{display:'flex', alignItems:'center', justifyContent:'flex-end', mt:2}}>\r\n            <Button type=\"submit\" variant=\"contained\" disabled={loading}>\r\n              {loading ? <CircularProgress size={18} color=\"inherit\" /> : 'Masuk'}\r\n            </Button>\r\n          </Box>\r\n        </form>\r\n      </Paper>\r\n    </Box>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}